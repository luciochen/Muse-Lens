# 预览崩溃问题修复

## 问题原因

SwiftUI Preview 崩溃通常是因为：

1. **相机权限访问**：`CameraCaptureView` 在预览中尝试访问相机，但预览环境不支持
2. **AVFoundation API**：预览环境无法使用需要实际设备的 API
3. **服务初始化**：某些服务在预览中初始化时可能失败

## 已修复的内容

### 1. ContentView 预览
- 改为简单的静态预览，不加载 `CameraCaptureView`
- 避免在预览中触发相机权限检查

### 2. CameraView 预览
- 创建了静态 UI 预览，不包含实际的相机功能
- 显示界面布局，但不触发任何需要权限的操作

### 3. 相机权限检查
- 添加了预览模式检测
- 在预览模式下跳过相机权限请求，避免崩溃

## 如何使用预览

### 方法 1：使用静态预览（推荐）
- 直接查看 `ContentView.swift` 或 `CameraView.swift` 的预览
- 预览会显示静态 UI，不会崩溃

### 方法 2：在模拟器或真机上运行
- 如果要测试完整的相机功能，需要在模拟器或真机上运行
- 按 `Cmd + R` 运行应用

## 注意事项

- **预览环境限制**：SwiftUI Preview 不支持：
  - 相机访问
  - 某些系统权限
  - 网络请求（可能）
  - 文件系统访问（受限）

- **测试完整功能**：请使用模拟器或真机运行应用

## 如果预览仍然崩溃

1. **清理预览缓存**：
   - Xcode → Product → Clean Build Folder
   - 关闭并重新打开预览

2. **检查编译错误**：
   - 确保所有代码都能正常编译
   - 查看是否有警告或错误

3. **重启 Xcode**：
   - 有时预览缓存会导致问题
   - 完全退出并重新打开 Xcode

